<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>公司管理系统</title>
    <link rel="stylesheet" href="../leaflet/leaflet.css">
    <script src="../../js/jquery-1.3.1.js"></script>
    <script src="../../js/jquery.tmpl.js"></script>
    <style>

        html, body, #map {
            height: 100%;
            padding: 0;
            margin: 0;
        }

        #forkongithub a {
            background: #000;
            color: #fff;
            text-decoration: none;
            font-family: arial,sans-serif;
            text-align: center;
            font-weight: bold;
            padding: 5px 40px;
            font-size: 1rem;
            line-height: 2rem;
            position: relative;
            transition: 0.5s;
        }

            #forkongithub a:hover {
                background: #c11;
                color: #fff;
            }

            #forkongithub a::before, #forkongithub a::after {
                content: "";
                width: 100%;
                display: block;
                position: absolute;
                top: 1px;
                left: 0;
                height: 1px;
                background: #fff;
            }

            #forkongithub a::after {
                bottom: 1px;
                top: auto;
            }

        @media screen and (min-width:800px) {
            #forkongithub {
                position: fixed;
                display: block;
                top: 0;
                right: 0;
                width: 200px;
                overflow: hidden;
                height: 200px;
                z-index: 9999;
            }

                #forkongithub a {
                    width: 200px;
                    position: absolute;
                    top: 60px;
                    right: -60px;
                    transform: rotate(45deg);
                    -webkit-transform: rotate(45deg);
                    -ms-transform: rotate(45deg);
                    -moz-transform: rotate(45deg);
                    -o-transform: rotate(45deg);
                    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
                }
        }
    </style>
</head>
<body>
    <span id="forkongithub"><a href="../../index.aspx">回返</a></span>
    <div id="map"></div>
    <script src="../dist/main.min.js"></script>
    <script>
        var map = L.map('map');
        var baseLayers = {
            "高德地图": L.tileLayer('http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}', {
                subdomains: "1234"
            }),
            '高德影像': L.layerGroup([L.tileLayer('http://webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}', {
                subdomains: "1234"
            }), L.tileLayer('http://t{s}.tianditu.cn/DataServer?T=cta_w&X={x}&Y={y}&L={z}', {
                subdomains: "1234"
            })]),
            "立体地图": L.tileLayer('https://a.tiles.mapbox.com/v3/examples.c7d2024a/{z}/{x}/{y}.png', {
                attribution: 'Map &copy; Pacific Rim Coordination Center (PRCC).  Certain data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
                key: 'BC9A493B41014CAABB98F0471D759707',
                styleId: 22677
            }),
            "Foursquare": L.tileLayer('https://a.tiles.mapbox.com/v3/foursquare.map-0y1jh28j/{z}/{x}/{y}.png', {
                attribution: 'Map &copy; Pacific Rim Coordination Center (PRCC).  Certain data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
                key: 'BC9A493B41014CAABB98F0471D759707',
                styleId: 22677
            }),
            'GeoQ灰色底图': L.tileLayer('http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}').addTo(map)
        };
        L.tileLayer('https://a.tiles.mapbox.com/v3/foursquare.map-0y1jh28j/{z}/{x}/{y}.png', {
            attribution: 'Map &copy; Pacific Rim Coordination Center (PRCC).  Certain data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
            key: 'BC9A493B41014CAABB98F0471D759707',
            styleId: 22677
        });
        var layercontrol = L.control.layers(baseLayers, {}, {
            position: "topleft"
        }).addTo(map);
        map.setView(L.latLng(37.550339, 104.114129), 4);
        var overlay = new L.echartsLayer3(map, echarts);
        var chartsContainer = overlay.getEchartsContainer();
        var myChart = overlay.initECharts(chartsContainer);
        var data = [                     
            { name: '青岛', value: 18 },
            { name: '莱西', value: 21 },
            { name: '日照', value: 21 },
            { name: '胶南', value: 22 },
            { name: '南通', value: 23 },
            { name: '梅州', value: 25 },
            { name: '文登', value: 25 },
            { name: '上海', value: 25 },

            { name: '承德', value: 25 },
            { name: '厦门', value: 26 },
            { name: '烟台', value: 28 },
            { name: '抚顺', value: 31 },
            { name: '玉溪', value: 31 },
            { name: '张家口', value: 31 },
            { name: '阳泉', value: 31 },
            { name: '葫芦岛', value: 35 },
            { name: '常熟', value: 36 },
            { name: '东莞', value: 36 },
            { name: '河源', value: 36 },
            { name: '淮安', value: 36 },
            { name: '泰州', value: 36 },
            { name: '南宁', value: 37 },
            { name: '营口', value: 37 },
            { name: '惠州', value: 37 },
            { name: '江阴', value: 37 },
            { name: '蓬莱', value: 37 },
            { name: '韶关', value: 38 },
            { name: '嘉峪关', value: 38 },
            { name: '广州', value: 38 },
            { name: '延安', value: 38 },
            { name: '太原', value: 39 },
            { name: '清远', value: 39 },
            { name: '中山', value: 39 },
            { name: '昆明', value: 39 },
            { name: '寿光', value: 40 },
            { name: '盘锦', value: 40 },
            { name: '长治', value: 41 },
            { name: '深圳', value: 41 },
            { name: '珠海', value: 42 },
            { name: '宿迁', value: 43 },
            { name: '咸阳', value: 43 },
            { name: '铜川', value: 44 },
            { name: '平度', value: 44 },
            { name: '佛山', value: 44 },
            { name: '海口', value: 44 },
            { name: '江门', value: 45 },
            { name: '章丘', value: 45 },
            { name: '肇庆', value: 46 },
            { name: '大连', value: 47 },
            { name: '临汾', value: 47 },
            { name: '吴江', value: 47 },
            { name: '石嘴山', value: 49 },
            { name: '沈阳', value: 50 },
            { name: '苏州', value: 50 },
            { name: '茂名', value: 50 },
            { name: '嘉兴', value: 51 },
            { name: '长春', value: 51 },
            { name: '胶州', value: 52 },
            { name: '银川', value: 52 },
            { name: '张家港', value: 52 },
            { name: '三门峡', value: 53 },
            { name: '锦州', value: 54 },
            { name: '南昌', value: 54 },
            { name: '柳州', value: 54 },
            { name: '三亚', value: 54 },
            { name: '自贡', value: 56 },
            { name: '吉林', value: 56 },
            { name: '阳江', value: 57 },
            { name: '泸州', value: 57 },
            { name: '西宁', value: 57 },
            { name: '宜宾', value: 58 },
            { name: '呼和浩特', value: 58 },
            { name: '成都', value: 58 },
            { name: '大同', value: 58 },
            { name: '镇江', value: 59 },
            { name: '桂林', value: 59 },
            { name: '张家界', value: 59 },
            { name: '宜兴', value: 59 },
            { name: '北海', value: 60 },
            { name: '西安', value: 61 },
            { name: '金坛', value: 62 },
            { name: '东营', value: 62 },
            { name: '牡丹江', value: 63 },
            { name: '遵义', value: 63 },
            { name: '绍兴', value: 63 },
            { name: '扬州', value: 64 },
            { name: '常州', value: 64 },
            { name: '潍坊', value: 65 },
            { name: '重庆', value: 66 },
            { name: '台州', value: 67 },
            { name: '南京', value: 67 },
            { name: '宝鸡', value: 72 },
            { name: '焦作', value: 75 },
            { name: '北京', value: 79 },
            { name: '杭州', value: 84 },
            { name: '安阳', value: 90 },
            { name: '开封', value: 90 },
            { name: '沧州', value: 100 },
            { name: '临沂', value: 103 },
            { name: '南充', value: 104 },
            { name: '天津', value: 105 },
            { name: '诸暨', value: 112 },
            { name: '郑州', value: 113 },
            { name: '聊城', value: 116 },
            { name: '芜湖', value: 117 },
            { name: '唐山', value: 119 },
            { name: '平顶山', value: 119 },
            { name: '邢台', value: 119 },
            { name: '德州', value: 120 },
            { name: '济宁', value: 120 },
            { name: '荆州', value: 127 },
            { name: '洛阳', value: 134 },
            { name: '长沙', value: 175 },
            { name: '武汉', value: 273 },
 
        ];

        $.ajax({
            url: "/Handler/Handler.ashx",
            data: {},
            async: false,
            dataType: "json",
            type: "get",
            success: function (result) {
                data = result;

            }
        })

        var geoCoordMap = {

            '赤峰': [118.87, 42.28],
            '青岛': [120.33, 36.07],
            '日照': [119.46, 35.42],
            '胶南': [119.97, 35.88],
            '南通': [121.05, 32.08],
            '上海': [121.48, 31.22],
            '厦门': [118.1, 24.46],
            '烟台': [121.39, 37.52],
            '福州': [119.3, 26.08],
            '阳泉': [113.57, 37.85],
            '莱州': [119.942327, 37.177017],
            '湖州': [120.1, 30.86],
            '汕头': [116.69, 23.39],
            '昆山': [120.95, 31.39],
            '宁波': [121.56, 29.86],
            '葫芦岛': [120.836932, 40.711052],
            '常熟': [120.74, 31.64],
            '东莞': [113.75, 23.04],
            '广州': [113.23, 23.16],
            '延安': [109.47, 36.6],
            '太原': [112.53, 37.87],
            '清远': [113.01, 23.7],
            '中山': [113.38, 22.52],
            '昆明': [102.73, 25.04],
            '寿光': [118.73, 36.86],
            '盘锦': [122.070714, 41.119997],
            '长治': [113.08, 36.18],
            '深圳': [114.07, 22.62],
            '苏州': [120.62, 31.32],
            '三门峡': [111.19, 34.76],
            '成都': [104.06, 30.67],
            '西安': [108.95, 34.27],
            '重庆': [106.54, 29.59],
            '南京': [118.78, 32.04],
            '焦作': [113.21, 35.24],
            '北京': [116.46, 39.92],
            '枣庄': [117.57, 34.86],
            '杭州': [120.19, 30.26],
            '安阳': [114.35, 36.1],
            '开封': [114.35, 34.79],
            '郑州': [113.65, 34.76],
            '洛阳': [112.44, 34.7],
        };

        var convertData = function (data) {
            var res = [];
            for (var i = 0; i < data.length; i++) {
                var geoCoord = geoCoordMap[data[i].name];
                if (geoCoord) {
                    res.push({
                        name: data[i].name,
                        value: geoCoord.concat(data[i].value)
                    });
                }
            }
            return res;
        };
      

        option = {
            // backgroundColor: '#404a59',
            title: {
                text: '公司管理系统产品分布图',
                subtext: 'Hello Word',
                sublink: 'http://www.pm25.in',
                left: 'center',
                textStyle: {
                    color: '#CC00FF '
                }
            },
            tooltip: {
                trigger: 'item'
            },
            legend: {
                orient: 'vertical',
                y: 'bottom',
                x: 'right',
                data: ['线下网点'],
                textStyle: {
                    color: '#FF0 0FF '
                }
            },
            geo: {
                map: '',
                label: {
                    emphasis: {
                        show: false
                    }
                },
                roam: true,
                itemStyle: {
                    normal: {
                        areaColor: '#323c48',
                        borderColor: '#111'
                    },
                    emphasis: {
                        areaColor: '#2a333d'
                    }
                }
            },
            series: [
                {
                    name: '线下网点',
                    type: 'scatter',
                    coordinateSystem: 'geo',
                    data: convertData(data),
                    symbolSize: function (val) {
                        return val[2] / 10;
                    },
                    label: {
                        normal: {
                            formatter: '{b}',
                            position: 'right',
                            show: false
                        },
                        emphasis: {
                            show: true
                        }
                    },
                    itemStyle: {
                        normal: {
                            color: '#CC00FF '
                        }
                    }
                },
                {
                    name: '线下网点',
                    type: 'effectScatter',
                    coordinateSystem: 'geo',
                    data: convertData(data.sort(function (a, b) {
                        return b.value - a.value;
                    }).slice(0, 6)),
                    symbolSize: function (val) {
                        return val[2] / 10;
                    },
                    showEffectOn: 'render',
                    rippleEffect: {
                        brushType: 'stroke'
                    },
                    hoverAnimation: true,
                    label: {
                        normal: {
                            formatter: '{b}',
                            position: 'right',
                            show: true
                        }
                    },
                    itemStyle: {
                        normal: {
                            color: '#7700FF  ',
                            shadowBlur: 10,
                            shadowColor: '#7700FF   '
                        }
                    },
                    zlevel: 1
                }
            ]
        };
        // 使用刚指定的配置项和数据显示图表。
        overlay.setOption(option);
    </script>

 
</body>
</html>